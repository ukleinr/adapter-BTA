[TOC]

# 4 Управление Адаптером
В данном разделе будут подробно описаны все элементы управления Адаптером. До начала работы необходимо запустить основную оболочку SCORPIO и программу гидирования.

Иконки программ управления SCORPIO и камерой гидирования Atik: ![scorpio2Icon](pic/scorpio2Icon.png) ![scr_GuideIcon](pic/scr_GuideIcon.png)

## Общий вид

Блок управления Адаптером находится в нижней части общей оболочки управления SCORPIO-1/2:

![scr_RCbuttons](pic/scr_RCbuttons.png)

В отличие от интерфейса управления старой платформой, есть особенности использования текущего интерфейса:

- Положение зеркала, ламп и концевиков подвижек постоянно мониторятся и отображаются.
  Во время переезда, состояние зеркала = GO.
- У лампы FLAT - два параметра: QUARTZ (лампа непрерывного спектра) и LEDs (линейка
  светодиодов). Можно выделить флажком один или сразу оба.
- Вместо того, чтобы нажимать кнопки **`MOVE fiber 1/2`**, **`MOVE FIBERS`**,  **`SHIFT, pх CCD`**,
  достаточно нажать [ENTER] в соответствующем поле.
- Можно одновременно запускать перемещения любого элемента, пока другие еще едут.
- Если нажать одновременно стрелочки X и Y – будет ехать сразу по обеим координатам.
- Кнопка **`set initial`** устанавливает в ноль только X и Y, не двигая фокус и зеркало.
- Добавлена кнопка вызова программы управления светодиодами и лампами LEDs menu
- Управление фокусами обоих микроскопов вынесено в отдельное меню (**рис. ??**), запускаемое кнопкой **`focusing`**. Из этого меню есть возможность двигать фокус стрелочками с клавиатуры, зарезервированы поля для автофокусировки.

Рассмотрим далее каждый элемент управления.

## Поворотный стол

Для установки требуемой ориентации щели спектрографа необходимо в меню управления Адаптером нажать кнопку **`PA ROTATION`.** Открывается окно ‘POSITION ANGLE of the SLIT’ показанное на **рис**. ниже. 

![scr_PArotation](pic/scr_PArotation.png)

Здесь слева красной линией показано текущее положение щели спектрографа относительно направлений "север-юг" и "запад-восток, а справа такой же линией отмечено текущее положение поворотного стола ПФ. Красная стрелочка показывает скорость вращения стола в единицах <sup>◦</sup>/час.
Ниже в виде таблицы указаны текущие значения **Current** угла поворотного стола **PA(table)** и позиционного угла щели **PA(slit)** (отсчитывается от направления на север против часовой стрелки). 

В графе **Texp** показывается время, оставшееся до достижения концевика поворотного стола (т.е. максимальное время экспозиции, при условии, что будут продолжаться наблюдения данного объекта).

Графа **New** предназначена для ввода новых значений углов. Причем можно вводить как значения PA(slit), так и PA(table), при вводе одного из этих углов второй пересчитывается (константу для пересчета программа берет из конфигурационного файла). Новые значения углов отображаются на графиках синим пунктиром, а в графе Texp показывается максимально возможное время экспозиции с новым положением поворотного стола. Нажатие кнопки **`PA+180`** меняет значения новых углов на 180<sup>◦</sup>, это полезно в тех случаях, когда требуются либо более продолжительные экспозиции, либо меньшее различие между текущим и новым положением поворотного стола. 

Нажатие кнопки **`Rotation`** приводит к вращению поворотного стола к его новому положению. Остановить вращение стола из этого меню нельзя, надо использовать программы непосредственного управления телескопом на компьютере robs1 (интерфейс оператора БТА и т.п.).
**`QUIT`** – выход из программы.

> ВНИМАНИЕ: для корректной работы требуется запуск скрипта bta_control_net на рабочем столе управляющего компьютера.

## Поиск звезд гидирования

Программа для поиска звезд гидирования  запускается кнопкой **`FIND GUIDING STARS`**

![scr_FindStars](pic/scr_FindStars.png)

В основной части окна приводится полное поле зрения со звездами из каталога USNO2.0. По периметру приводятся отметки шкалы позиционного угла PA(table), а красной стрелкой указано текущее значение (на **рис**. это PA(table) = 135). Внизу слева указывается отличие от направления атмосферной дисперсии, а внизу справа — координаты курсора в экваториальных координатах RA(2000) и DEC(2000).

Кроме большой карты поля Адаптера, справа имеется три дополнительных увеличенных карты: 

- звездная карта матрицы CCD: для основного квадратного поля (верхняя панель) с вертикальной щелью, 
- звездная карта подсмотра FIELD: с горизонтальной щелью (**FIXME**: есть отличия в версиях SCORPIO 1 и 2)
- звездная карта подсмотра FIBERS: круги с крестами под надписями #2 и #1

Итак, большой центральный квадрат в окне отмечает положение поля зрения SCORPIO-2 (6’ × 6’),  прямоугольниками выделены положения пределов перемещения полей гидирования, внутри которых программа ищет звезды для гидирования. Маленькими кружками, размеры которых соответствуют диаметрам жгутов световодов, выделены наиболее яркие звезды, которые были автоматически выбраны программой. Их звездные величины и положение в системе координат Адаптера (x 21.81 y 8.30; x 15.61 y 17.92) отображаются в правых нижних полях окна программы – подписи под кругами фиберов #2 и #1. При необходимости наблюдатель может c помощью курсора выбрать и установить левым кликом другую опорную звезду из доступных в основном поле. 

Кнопка `load telescope parameters` обновляет содержимое всех полей окна, что может полезно при смещениях и поворотах стола при поиске гидировочных звезд в бедных полях.

`EXIT` - закрывает окно.

>  ВНИМАНИЕ: Возможна предварительная установка звезд во время перенаведения телескопа с одного объекта на другой.

## Диагональное зеркало и осветители

![](pic/scr_RCbuttons1.png)

Кнопка **`MIRROR`**  переключает диагональное зеркало (или переброса) между двумя положениями — *FIELD* и *FIBERS*.

Кнопка **`NEON`**  принудительно включает лампу линейчатого спектра He-Ne-Ar.

Кнопка **`FLAT`**  принудительно включает лампу непрерывного спектра на основе кварца.

- [ ] QUARTZ  - флажок, позволяющий использовать кварцевую лампу в режиме накоплений **flat**
- [x] LEDs - флажок, позволяющий использовать светодиоды в режиме накоплений **flat**



## Коррекция телескопа в терминах пикселей CCD

Данная панель использует для точного наведения на щель и иных задач с помощью отправки смещений положения телескопа в системе координат CCD (X - горизонтальное смещение, Y - вертикальное смещение). 

![scr_RCbuttons2](pic/scr_RCbuttons2.png)

Кнопка **`SHIFT, px CCD`** отправляет коррекции на телескоп, исходя из значения из полей **X:** и **Y:**, заданных в пикселах.

Смещение ползунков влево и вправо позволяет настроить значение смещения грубо. Для малых коррекций (особенно при установке объекта на щель) вводится более точное значение.

Кроме наведения на щель, функция **`SHIFT, px CCD`** используется в фотометрических наблюдениях, а также при получении плоских сумеречных полей для смещения кадра и последующего медианного исключения звезд.

> ВНИМАНИЕ: для корректной работы требуется запуск скрипта bta_control_net на рабочем столе управляющего компьютера.

## Подвижки поисковых фиберов

![scr_RCbuttons3](pic/scr_RCbuttons3.png)

## Дополнительная панель

![scr_RCbuttons4](pic/scr_RCbuttons4.png)

**`MOVE FIBERS`** — устанавливает фиберы на значения из полей

**`Set guiding stars`** — забирает значения из полей фиберов из программы поиска звезд

**`set initial`** — устанавливает фиберы “в ноль”, т.е. на нуль-концевики

**`Focusing`** — фокусировка фиберов (отдельное окно)

**`LEDS menu`** — ручное управление светодиодами (отдельное окно)

**`Save calibration `** — (сервисная функция) сохраняет в специальный файл звездные величины для фотометрической калибровки гида (уточнить по коду)



## Фокусировка фиберов

<img src="pic/fiberFocus.png" style="zoom:50%;" />




## Программа гидирования AtikGuide



![scr_Guide](pic/scr_Guide.png)





![scr_GuideLog](pic/scr_GuideLog.png)



![scr_Monitoring](pic/scr_Monitoring.png)

